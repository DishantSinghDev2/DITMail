;————————————————————————————————————————————————————
; Core settings
;————————————————————————————————————————————————————
[redis]
; point edge-case: use a dedicated DB to avoid clashing with other stats
host   = 127.0.0.1
port   = 6379
db     = 1
expire_days = 30       ; shorten expiry so history lookups stay small

[tarpit]
delay=1                ; minimal per-connection delay
max=2                  ; maximum tarpit delay (keep low to avoid dropped connections)
max_msa=1

;————————————————————————————————————————————————————
; Thresholds & deny policy
;————————————————————————————————————————————————————
[thresholds]
negative=-6            ; reject faster on poorer reputation
positive=2
history_negative=-2

[deny]
hooks=connect,data_post    ; deny early if below negative
message=Your karma score ({score}) is too low, sorry.

[deny_excludes]
; allow these plugins to still reject regardless of low karma
plugins=dnsbl,fcrdns,spf
hooks=rcpt,queue

;————————————————————————————————————————————————————
; Minimal awards & penalties
;————————————————————————————————————————————————————
[awards]
early_talker      = -5     ; big hit for known spam bot pattern

;————————————————————————————————————————————————————
; ASN-based scoring
;————————————————————————————————————————————————————
[asn]
enable=true

;————————————————————————————————————————————————————
; Result awards: only key signals
;————————————————————————————————————————————————————
[result_awards]
001 = spf         | result | equals | Fail      | -10 | SPF failed
002 = spf         | result | equals | Pass      |  1  | SPF passed
003 = dnsbl       | fail   | equals | zen.spamhaus.org        | -20 | Listed in Spamhaus
004 = dnsbl       | fail   | equals | bl.spamcop.net          | -5  | Listed in SpamCop

;————————————————————————————————————————————————————
; Streamline out everything else
;————————————————————————————————————————————————————
; Remove geoip, complex regex, and all the unused / low-value awards
